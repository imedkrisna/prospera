<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Krisna Gupta">
<meta name="dcterms.date" content="2023-11-03">

<title>excise report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="excise_doc_files/libs/clipboard/clipboard.min.js"></script>
<script src="excise_doc_files/libs/quarto-html/quarto.js"></script>
<script src="excise_doc_files/libs/quarto-html/popper.min.js"></script>
<script src="excise_doc_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="excise_doc_files/libs/quarto-html/anchor.min.js"></script>
<link href="excise_doc_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="excise_doc_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="excise_doc_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="excise_doc_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="excise_doc_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="excise_doc_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="excise_doc_files/libs/tabwid-1.1.3/tabwid.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="excise_doc.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="excise_doc.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">excise report</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Krisna Gupta </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Prospera
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 3, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="data" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="data"><span class="header-section-number">1</span> Data</h2>
<p>aowkaowkaowk</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="excise_doc_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="excise_doc_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="method" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="method"><span class="header-section-number">2</span> Method</h2>
<p>Let a standard elasticity parameters</p>
<p><span class="math display">
Q_i=AP_i^{-\varepsilon}
</span></p>
<p>which can be approximately log-linearized</p>
<p><span class="math display">
q_i=a-\varepsilon p_i
</span></p>
<p>where a lowercase is the log version of its uppercase counterparts. We can, thus, econometrically estimated the above equation with a regression. Additionally, we follow the theory in having an income elasticity with GDP per capita as a proxy. We then estimate:</p>
<p><span class="math display">
q_{it}=a-\varepsilon p_{it} + \gamma y_{it} + \epsilon_{it}
</span></p>
<p>We assume an iid <span class="math inline">\epsilon_{it}</span> for now and uses own-price elasticity since we lack information on the price of electric cigs. The parameter <span class="math inline">\varepsilon</span> is the own-price elasticity of demand, which we expect to be negative, while <span class="math inline">\gamma</span> is the income elasticity of demand which is assumed to be positive.</p>
</section>
<section id="results" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="results"><span class="header-section-number">3</span> Results</h2>
<p>We use data that are made available by DGCE for us. Data contains production, revenue, base price (HJE) for tax purposes and retail price (HTE) for consumers for various types of traditional and electric cigarettes. Unfortunately, the availability of those data differs quite tremendously. Some are collected monthly, some others are quarterly and annually. Common denominator suggests us to conduct the analysis annually.</p>
<p>Since we lack degree of freedom amid lack of data, it does make sense to group kinds of cigarettes into two: traditional and electric. We aggregate variables using weighted average using production data of each kind of cigarettes as the weight.</p>
<section id="elasticities-traditional-cigarettes" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="elasticities-traditional-cigarettes"><span class="header-section-number">3.1</span> Elasticities: traditional cigarettes</h3>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-1" class="anchored">

<div class="tabwid"><style>.cl-7979a33c{}.cl-796ff440{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7974053a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-79741da4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-79741dae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-79741daf{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-79741db8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-79741db9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-7979a33c"><caption>Table&nbsp;1:  <p>Demand elasticity estimation for three kinds of traditional
cigarettes</p> </caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-79741da4"><p class="cl-7974053a"><span class="cl-796ff440"> </span></p></th><th class="cl-79741da4"><p class="cl-7974053a"><span class="cl-796ff440">Traditional</span></p></th><th class="cl-79741da4"><p class="cl-7974053a"><span class="cl-796ff440">SKM</span></p></th><th class="cl-79741da4"><p class="cl-7974053a"><span class="cl-796ff440">SKT</span></p></th><th class="cl-79741da4"><p class="cl-7974053a"><span class="cl-796ff440">SPM</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(Intercept)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">25.750**</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">6.592+</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-9.257</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">4.212</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440"></span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(1.571)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(2.048)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(6.921)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(3.185)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">own-price</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-0.479</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-0.782+</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.873</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-1.216*</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440"></span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(0.212)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(0.202)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(1.497)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(0.274)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">y</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.525</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.578</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.879</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.900</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440"></span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(0.311)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(0.369)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(1.403)</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">(0.546)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741daf"><p class="cl-7974053a"><span class="cl-796ff440">Num.Obs.</span></p></td><td class="cl-79741daf"><p class="cl-7974053a"><span class="cl-796ff440">5</span></p></td><td class="cl-79741daf"><p class="cl-7974053a"><span class="cl-796ff440">5</span></p></td><td class="cl-79741daf"><p class="cl-7974053a"><span class="cl-796ff440">5</span></p></td><td class="cl-79741daf"><p class="cl-7974053a"><span class="cl-796ff440">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">R2</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.722</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.917</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.663</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.935</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">R2 Adj.</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.444</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.835</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.326</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">0.870</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">AIC</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-17.4</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-15.3</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-2.1</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-10.9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">BIC</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-18.9</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-16.9</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-3.6</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">-12.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">Log.Lik.</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">12.692</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">11.657</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">5.039</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">9.473</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">F</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">2.597</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">11.089</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">1.967</span></p></td><td class="cl-79741dae"><p class="cl-7974053a"><span class="cl-796ff440">14.360</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-79741db8"><p class="cl-7974053a"><span class="cl-796ff440">RMSE</span></p></td><td class="cl-79741db8"><p class="cl-7974053a"><span class="cl-796ff440">0.02</span></p></td><td class="cl-79741db8"><p class="cl-7974053a"><span class="cl-796ff440">0.02</span></p></td><td class="cl-79741db8"><p class="cl-7974053a"><span class="cl-796ff440">0.09</span></p></td><td class="cl-79741db8"><p class="cl-7974053a"><span class="cl-796ff440">0.04</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-79741db9"><p class="cl-7974053a"><span class="cl-796ff440">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</span></p></td></tr></tfoot></table></div>
</div>
</div>
</div>
<p>The elasticity of the traditional cigarettes is -0.4791002 which is the decrease in sales if prices go up by 1%. Meanwhile, 0.5248967is the income-effect, that is, how much more sales go up if GDP per capita rises by 1%.</p>
<p>We can then propose an elasticity equation as such:</p>
<p><span class="math display">
Q_{trad}=\frac{Y^{0.52}}{P_{trad}^{0.48}}\cdot e^{25.75}
</span></p>
<p>This parameter is actually make sense. The inelasticity of cigarette demands is quite well-known.</p>
<p>We also examine if it matters by different kinds:</p>
</section>
<section id="tax-price-pass-through" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="tax-price-pass-through"><span class="header-section-number">3.2</span> Tax-price pass through</h3>
<p>In the terms of excise, DGCE is interested in knowing how much their additional excise matters for the change in prices, which in turn matter in the change in quantities. We estimate how much prices changes when excise changes with the following specification:</p>
<p><span class="math display">
\ln P_t = \alpha+\beta \ln T_t + \varepsilon_{t}
</span></p>
<p>The result of that regression is as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-2" class="anchored">

<div class="tabwid"><style>.cl-7a26fa46{}.cl-7a1d3416{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7a20cb4e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7a20e264{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a20e26e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a20e26f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a20e270{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7a20e271{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-7a26fa46"><caption>Table&nbsp;2:  <p>Tax-to-price pass through for three kinds of traditional
cigarettes</p> </caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-7a20e264"><p class="cl-7a20cb4e"><span class="cl-7a1d3416"> </span></p></th><th class="cl-7a20e264"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">Traditional</span></p></th><th class="cl-7a20e264"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">SKM</span></p></th><th class="cl-7a20e264"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">SKT</span></p></th><th class="cl-7a20e264"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">SPM</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">(Intercept)</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">1.940*</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">2.399**</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">4.299</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">2.651*</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416"></span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">(0.493)</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">(0.257)</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">(12.330)</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">(0.483)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">own-excise</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.879**</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.798***</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.532</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.759**</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416"></span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">(0.078)</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">(0.039)</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">(2.248)</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">(0.074)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26f"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">Num.Obs.</span></p></td><td class="cl-7a20e26f"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">5</span></p></td><td class="cl-7a20e26f"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">5</span></p></td><td class="cl-7a20e26f"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">5</span></p></td><td class="cl-7a20e26f"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">R2</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.977</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.993</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.018</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.972</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">R2 Adj.</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.969</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.990</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">-0.309</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.963</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">AIC</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">-20.5</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">-24.1</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">-6.2</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">-16.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">BIC</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">-21.7</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">-25.2</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">-7.4</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">-17.7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">Log.Lik.</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">13.267</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">15.031</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">6.118</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">11.246</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">F</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">127.688</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">407.922</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.056</span></p></td><td class="cl-7a20e26e"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">104.179</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7a20e270"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">RMSE</span></p></td><td class="cl-7a20e270"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.02</span></p></td><td class="cl-7a20e270"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.01</span></p></td><td class="cl-7a20e270"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.07</span></p></td><td class="cl-7a20e270"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">0.03</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-7a20e271"><p class="cl-7a20cb4e"><span class="cl-7a1d3416">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</span></p></td></tr></tfoot></table></div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ptrad ~ ctrad, data = dat)

Residuals:
        1         2         3         4         5 
-0.017269  0.019518  0.007412 -0.023142  0.013481 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  1.93985    0.49265   3.938  0.02918 * 
ctrad        0.87923    0.07781  11.300  0.00149 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.022 on 3 degrees of freedom
Multiple R-squared:  0.977, Adjusted R-squared:  0.9694 
F-statistic: 127.7 on 1 and 3 DF,  p-value: 0.001486</code></pre>
</div>
</div>
<p>This estimation result tells us a very strong impact of taxation on prices. That is, for each 1% increase in excise, it passes 0.8792325 % to the consumer via increased price. This estimation is arguable higher than <span class="citation" data-cites="Prasetyo618">Prasetyo and Adrison (<a href="#ref-Prasetyo618" role="doc-biblioref">2020</a>)</span> which conducted a firm-level estimation.</p>
<p>We then examine whether it make sense to estimate between different types of traditional cigarettes:</p>
<ul>
<li>SKM</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = pskm ~ cskm, data = trad)

Residuals:
        1         2         3         4         5 
-0.017864  0.015538  0.008314 -0.008875  0.002886 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.39938    0.25690    9.34 0.002599 ** 
cskm         0.79760    0.03949   20.20 0.000265 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01546 on 3 degrees of freedom
Multiple R-squared:  0.9927,    Adjusted R-squared:  0.9903 
F-statistic: 407.9 on 1 and 3 DF,  p-value: 0.0002653</code></pre>
</div>
</div>
<ul>
<li>SKT</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = pskt ~ cskt, data = trad)

Residuals:
       1        2        3        4        5 
-0.07304 -0.01295 -0.01731 -0.03258  0.13589 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   4.2994    12.3304   0.349    0.750
cskt          0.5324     2.2482   0.237    0.828

Residual standard error: 0.09188 on 3 degrees of freedom
Multiple R-squared:  0.01835,   Adjusted R-squared:  -0.3089 
F-statistic: 0.05607 on 1 and 3 DF,  p-value: 0.8281</code></pre>
</div>
</div>
<ul>
<li>SPM</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = pspm ~ cspm, data = trad)

Residuals:
        1         2         3         4         5 
-0.010214  0.007932  0.025630 -0.044546  0.021199 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   2.6513     0.4830    5.49   0.0119 * 
cspm          0.7594     0.0744   10.21   0.0020 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03295 on 3 degrees of freedom
Multiple R-squared:  0.972, Adjusted R-squared:  0.9627 
F-statistic: 104.2 on 1 and 3 DF,  p-value: 0.002004</code></pre>
</div>
</div>
<p>Results from each</p>
</section>
<section id="revenue-from-price-and-from-tax-rate" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="revenue-from-price-and-from-tax-rate"><span class="header-section-number">3.3</span> Revenue from price and from tax rate</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = revtrad ~ ctrad + y, data = dat)

Residuals:
         1          2          3          4          5 
-0.0228236  0.0147477  0.0004673  0.0247555 -0.0171469 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  -2.5429     1.6020  -1.587   0.2534  
ctrad         0.5917     0.1684   3.515   0.0723 .
y             0.4830     0.2778   1.739   0.2242  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02868 on 2 degrees of freedom
Multiple R-squared:  0.9719,    Adjusted R-squared:  0.9438 
F-statistic: 34.59 on 2 and 2 DF,  p-value: 0.0281</code></pre>
</div>
</div>
<ul>
<li>SKM</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rskm ~ cskm + y, data = trad)

Residuals:
        1         2         3         4         5 
-0.020994  0.012364 -0.003082  0.031767 -0.020055 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  -2.0717     1.9461  -1.065    0.399
cskm          0.3746     0.1351   2.772    0.109
y             0.5646     0.3088   1.828    0.209

Residual standard error: 0.03174 on 2 degrees of freedom
Multiple R-squared:  0.9637,    Adjusted R-squared:  0.9275 
F-statistic: 26.58 on 2 and 2 DF,  p-value: 0.03626</code></pre>
</div>
</div>
<ul>
<li>SKT</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rskt ~ cskt + y, data = trad)

Residuals:
        1         2         3         4         5 
-0.037256 -0.006483  0.002474  0.080659 -0.039394 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -45.5216    11.4108  -3.989   0.0575 .
cskt          5.9142     1.7805   3.322   0.0799 .
y             1.9232     0.4248   4.527   0.0455 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0689 on 2 degrees of freedom
Multiple R-squared:  0.9242,    Adjusted R-squared:  0.8483 
F-statistic: 12.19 on 2 and 2 DF,  p-value: 0.07584</code></pre>
</div>
</div>
<ul>
<li>SPM</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rspm ~ cspm + y, data = trad)

Residuals:
        1         2         3         4         5 
-0.020414  0.015209  0.008042  0.003455 -0.006293 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -6.68233    1.23425  -5.414   0.0325 *
cspm         0.00190    0.07323   0.026   0.9817  
y            1.04918    0.18933   5.542   0.0311 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01955 on 2 degrees of freedom
Multiple R-squared:  0.9771,    Adjusted R-squared:  0.9541 
F-statistic: 42.58 on 2 and 2 DF,  p-value: 0.02295</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qskm ~ pskm + pspm + pskt, data = trad)

Residuals:
        1         2         3         4         5 
-0.025048  0.017589  0.014311  0.002962 -0.009814 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   4.0424     3.1306   1.291    0.420
pskm          2.5689     1.5995   1.606    0.355
pspm         -3.1810     1.6122  -1.973    0.299
pskt          0.8390     0.5433   1.544    0.366

Residual standard error: 0.03531 on 1 degrees of freedom
Multiple R-squared:  0.9627,    Adjusted R-squared:  0.8508 
F-statistic:   8.6 on 3 and 1 DF,  p-value: 0.2444</code></pre>
</div>
</div>
</section>
</section>
<section id="electric" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="electric"><span class="header-section-number">4</span> Electric</h2>
<p>Unfortunately, analyzing electric cigarettes is heavily constrained by the data. Since 2022 is the only year with a complete observation of production, revenue and prices, we cannot use econometric methods. We can, however, construct a direct derivation of elasticity from a simple algebra.</p>
<p>Assume a demand function as follows:</p>
<p><span class="math display">
Q_{el}=AP_{el}^{\nu}
</span></p>
<p>We can derive the elasticity <span class="math inline">\nu</span> by first doing a log-lineraization</p>
<p><span class="math display">
\ln Q_{el} = \nu \ln P_{el}+\ln A
</span></p>
<p>While this structure allows for an estimation of <span class="math inline">\nu</span> and <span class="math inline">A</span> as the intercept, parameterizing both are impossible unless we have more than 1 data point at the very least<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>One of a way to estimate <span class="math inline">\nu</span> is to use <span class="math inline">A</span> from the traditional cigarettes estimation.</p>
<p>which gives us:</p>
<p><span class="math display">
\nu= -\frac{\ln Q_{el}}{\ln P_{el}+\ln A}
</span></p>
</section>
<section id="limitation-suggestions" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="limitation-suggestions"><span class="header-section-number">5</span> Limitation &amp; Suggestions</h2>
<p>The main limitation is data. With the lack of annual data, we are limited to how much degree of freedom we can utilise. That is, we are limited to how much variable we can use in a single regression. Among the limitations are:</p>
<ul>
<li><p>traditional cigarettes:</p>
<ul>
<li><p>quarterly HTP:HJE data is useful.</p></li>
<li><p>production and revenue data is annual. Common denominator principle suggests we can only use annual data.</p></li>
<li><p>Data is limited to 2018-2022 for a full year of observation.</p></li>
</ul></li>
<li><p>electronic cigarettes:</p>
<ul>
<li><p>excellent monthly production and revenue data. However, monthly data often prone to seasonality and cyclicality.</p></li>
<li><p>HJE and HTP are only available for June 2022 and June 2023.</p></li>
<li><p>Names of cigs are different between different years.</p></li>
<li><p>consequence is more severe: only 2022 observation can be used.</p></li>
</ul></li>
</ul>
<p>Going forward, here are our recomendations regarding data for the DGCE:</p>
<ul>
<li><p>have a robust datasets which can easily be extracted into familiar form.</p></li>
<li><p>Keep collecting monthly data even though some HTP and HJE (or other regulations) do not change.</p></li>
<li><p>We propose a structure which can be extremely useful for future usage.</p></li>
</ul>
<p>For further analysis, we can recommend the use of other datasets, such as Susenas or other household surveys. Unfortunately, there is no going around the lack of data. Even if we can utilise other data, we will still need HTP:HJE and annual revenue from the DGCE.</p>

</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Prasetyo618" class="csl-entry" role="listitem">
Prasetyo, Bagus Wahyu, and Vid Adrison. 2020. <span>“Cigarette Prices in a Complex Cigarette Tax System: Empirical Evidence from Indonesia.”</span> <em>Tobacco Control</em> 29 (6): 618–23. <a href="https://doi.org/10.1136/tobaccocontrol-2018-054872">https://doi.org/10.1136/tobaccocontrol-2018-054872</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Obviously the more data point the better. While 2 data points are enough for parameterisation, it is not ideal.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>