#| echo: false
#| warning: false
#| message: false
#| error: false
library(tidyverse)
library(readxl)
library(modelsummary)
library(kableExtra)
library(gt)
theme_set(theme_classic())
dat<-read_excel("cukai_use.xlsx",sheet="gab")
dat2<-read_excel("cukai_use.xlsx",sheet="gabb")
trad<-read_excel("cukai_use.xlsx",sheet="trad")
trad2<-read_excel("cukai_use.xlsx",sheet="trad2")
tradviz<-read_excel("cukai_use.xlsx",sheet="tradviz")
elviz<-read_excel("cukai_use.xlsx",sheet="elviz")
tradviz$year<-as.Date(as.character(tradviz$year),format="%Y%m%d")
#elviz$year<-as.Date(as.character(elviz$year),format="%Y%m%d")
#| label: tbl-3
#| tbl-cap: Demand elasticity estimation for three kinds of traditional cigarettes
## Regressions
reg1<-lm(qtrad~htp+y,data=dat)
#| label: tbl-3
#| tbl-cap: Demand elasticity estimation for three kinds of traditional cigarettes
## Regressions
reg1<-lm(qtrad~htptrad+y,data=dat)
reg1skm<-lm(qskm~htpskm+y,data=trad)
reg1skt<-lm(qskt~htpskt+y,data=trad)
reg1spm<-lm(qspm~htpspm+y,data=trad)
## Tabling
ela<- list(
"Traditional" = reg1,
"SKM"  = reg1skm,
"SKT"  = reg1skt,
"SPM"  = reg1spm
)
modelsummary(ela,stars = TRUE,coef_rename=c("htp"="own-price",
"htpskm"="own-price",
"htpskt"="own-price",
"htpspm"="own-price"))
#| label: tbl-4
#| tbl-cap: Demand elasticity estimation,pooled with dummy
weks<-lm(qtrad~htp+y+kind,data=trad2)
modelsummary(weks,stars=TRUE,coef_rename=c("ptrad"="own-price"))
install.packages('flextable')
#| label: tbl-5
#| tbl-cap: Tax-to-price pass through for three kinds of traditional cigarettes
## Regressions
reg2<-lm(htptrad~ctrad,data=dat)
reg2skm<-lm(htpskm~cskm,data=trad)
reg2skt<-lm(htpskt~cskt,data=trad)
reg2spm<-lm(htpspm~cspm,data=trad)
## Tabling
tpp<- list(
"Traditional" = reg2,
"SKM"  = reg2skm,
"SKT"  = reg2skt,
"SPM"  = reg2spm
)
modelsummary(tpp,stars = TRUE,coef_rename=c("htp"="own-price",
"htpskm"="own-price",
"htpskt"="own-price",
"htpspm"="own-price",
"ctrad"="own-excise",
"cskm"="own-excise",
"cskt"="own-excise",
"cspm"="own-excise"))
#| label: fig-4
#| fig-cap: tax-price cross-sectional plot of traditional cigarettes.
#| warning: false
#| message: false
ggplot(data=trad2,aes(y=htp,x=ctrad,color=kind,shape=kind))+geom_point(size=2)+
stat_smooth(method = "lm")+labs(x="log excise",y="log price")
#| label: tbl-6
#| tbl-cap: tax-price passthrough estimation,pooled with dummy
wuks<-lm(htp~ctrad+y+kind,data=trad2)
modelsummary(wuks,stars=TRUE,coef_rename=c("ctrad"="own-excise"))
library(readxl)
asu<-read_excel("cukai_use2.xlsx")
asu<-read_excel("excise/cukai_use2.xlsx")
View(asu)
as.yearmon(paste(asu$Tahun," ",asu$BULAN),"%Y %m")
library(tidyverse)
as.yearmon(paste(asu$Tahun," ",asu$BULAN),"%Y %m")
library(zoo)
as.yearmon(paste(asu$Tahun," ",asu$BULAN),"%Y %m")
paste(asu$Tahun," ",asu$BULAN)
as.yearmon(paste(asu$Tahun,asu$BULAN),"%Y%m")
as.yearmon(paste(asu$Tahun,asu$BULAN),"%Y%b")
as.yearmon(paste(asu$Tahun,asu$BULAN),"%Y%M")
as.yearmon(paste(asu$Tahun,asu$BULAN),"%Y%B")
as.yearmon(paste(asu$Tahun,asu$BULAN),format="%Y%m")
asu$asu<-"asu"
asu |> mutate(asu=case_when(BULAN=="Jan"~1,))
asu |> mutate(asu=case_when(BULAN=="Jan"~1,
BULAN=="Feb"~2,
BULAN=="Mar"~3,
BULAN=="Apr"~4))
asu |> mutate(asu=case_when(BULAN=="Jan"~1,
BULAN=="Feb"~2,
BULAN=="Mar"~3,
BULAN=="Apr"~4,
BULAN=="May"~5,
BULAN=="Jun"~6,
BULAN=="JUL"~7,
BULAN=="Aug"~8,
BULAN=="Sep"~9,
BULAN=="Oct"~10,
BULAN=="Nov"~11,
BULAN=="Dec"~12))
library(tidyverse)
library(readxl)
trd<-read_excel("cukai_use2.xlsx")
library(tidyverse)
library(readxl)
trd<-read_excel("cukai_use2.xlsx")
library(tidyverse)
library(readxl)
trd<-read_excel("excise/cukai_use2.xlsx")
trd$mo<-"mo"
trd |> mutate(mo=case_when(BULAN=="Jan"~1,
BULAN=="Feb"~2,
BULAN=="Mar"~3,
BULAN=="Apr"~4,
BULAN=="May"~5,
BULAN=="Jun"~6,
BULAN=="JUL"~7,
BULAN=="Aug"~8,
BULAN=="Sep"~9,
BULAN=="Oct"~10,
BULAN=="Nov"~11,
BULAN=="Dec"~12))
trd |>
date<-as.yearmon(paste(trd$Tahun,trd$BULAN),format="%Y%m")
trd$date<-as.yearmon(paste(trd$Tahun,trd$BULAN),format="%Y%m")
trd
trd$date<-as.Date(paste(trd$Tahun,trd$BULAN),format="%Y%m")
trd
trd |> mutate(mo=case_when(BULAN=="Jan"01,
trd |> mutate(mo=case_when(BULAN=="Jan"~01,
BULAN=="Feb"~02,
BULAN=="Mar"~03,
BULAN=="Apr"~04,
BULAN=="May"~05,
BULAN=="Jun"~06,
BULAN=="JUL"~07,
BULAN=="Aug"~08,
BULAN=="Sep"~09,
BULAN=="Oct"~10,
BULAN=="Nov"~11,
BULAN=="Dec"~12))
trd$date<-as.Date(paste(trd$Tahun,trd$BULAN),format="%Y%m")
trd
trd |> mutate(mo=case_when(BULAN=="Jan"~01,
BULAN=="Feb"~02,
BULAN=="Mar"~03,
BULAN=="Apr"~04,
BULAN=="May"~05,
BULAN=="Jun"~06,
BULAN=="JUL"~07,
BULAN=="Aug"~08,
BULAN=="Sep"~09,
BULAN=="Oct"~10,
BULAN=="Nov"~11,
BULAN=="Dec"~12))
trd$date<-as.Date(paste(trd$Tahun,trd$BULAN),format="%Y%m")
trd
trd<-trd |> mutate(mo=case_when(BULAN=="Jan"~01,
BULAN=="Feb"~02,
BULAN=="Mar"~03,
BULAN=="Apr"~04,
BULAN=="May"~05,
BULAN=="Jun"~06,
BULAN=="JUL"~07,
BULAN=="Aug"~08,
BULAN=="Sep"~09,
BULAN=="Oct"~10,
BULAN=="Nov"~11,
BULAN=="Dec"~12))
trd
trd$date<-as.Date(paste(trd$Tahun,trd$BULAN),format="%Y%m")
trd
paste(trd$Tahun,trd$BULAN)
trd$date<-as.Date(paste(trd$Tahun,trd$mo),format="%Y%m")
trd
paste(trd$Tahun,trd$mo)
trd$date<-as.Date(paste(trd$Tahun,trd$mo),format="%Y %m")
trd
trd$date<-as.Date(paste(trd$Tahun,trd$mo),format="%Y %b")
as.Date(paste(trd$Tahun,trd$mo),format="%Y %b")
as.Date(paste(trd$Tahun,trd$mo),format="%Y %M")
trd$date<-as.Date(paste(trd$Tahun,trd$mo),format="%Y %M")
trd
trd$date<-as.Date(paste(trd$Tahun,trd$BULAN),format="%Y %M")
trd
trd<-trd |> mutate(mo=case_when(BULAN=="Jan"~"01",
BULAN=="Feb"~"02",
BULAN=="Mar"~"03",
BULAN=="Apr"~"04",
BULAN=="May"~"05",
BULAN=="Jun"~"06",
BULAN=="JUL"~"07",
BULAN=="Aug"~"08",
BULAN=="Sep"~"09",
BULAN=="Oct"~"10",
BULAN=="Nov"~"11",
BULAN=="Dec"~"12"))
trd$date<-as.Date(paste(trd$Tahun,trd$BULAN),format="%Y %M")
trd
trd$date<-as.Date(paste(trd$Tahun,trd$mo),format="%Y %M")
trd
trd$date<-as.Date(paste(trd$Tahun,trd$mo),format="%Y %m")
trd
as.Date(paste(trd$Tahun,trd$mo),format="%Y%m")
as.Date(paste(trd$Tahun,trd$mo),format="%Y%b")
as.yearmon(paste(trd$Tahun, " ", df$mo), "%Y %m")
as.yearmon(paste(trd$Tahun, " ", trd$mo), "%Y %m")
trd$date<-as.yearmon(paste(trd$Tahun, " ", trd$mo), "%Y %m")
trd
trd |> ggplot(aes(date,`CUKAI (RP T)`,color=`JENIS HT`))+geom_line()
quarterly <- aggregate(trd, nfrequency = 4)
quarterly <- aggregate(trd, nfrequency = 4, FUN = "sum")
quarterly <- aggregate(trd, nfrequency = 4, FUN = "sum)
quarterly <- aggregate(trd, nfrequency = 4, FUN = sum)
quarterly <- aggregate(trd, nfrequency = 4, FUN = mean)
quarterly <- aggregate(trd, nfrequency = 4, FUN = mean,by=date)
quarterly <- aggregate(trd, nfrequency = 4, FUN = mean,by=trd$date)
trd
trd |>
group_by(date,`JENIS HT`) |> aggregate(`CUKAI (RP T)`,sum
trd |>
trd |>
group_by(date,`JENIS HT`) |>
aggregate(`CUKAI (RP T)`,sum)
trd
trd |>
group_by(date,`JENIS HT`) |>
aggregate(trd$`CUKAI (RP T)`,sum)
trd |>
group_by(date,`JENIS HT`) |>
aggregate(trd$`CUKAI (RP T)`,by=date,sum)
trd |>
group_by(date,`JENIS HT`) |>
summarise(sum)
trd |>
group_by(date,`JENIS HT`) |>
summarise(weq=sum(`CUKAI (RP T`))
trd |>
group_by(date,`JENIS HT`) |>
summarise(weq=sum(`CUKAI (RP T)`))
trd$quarter<-case_when(date=="Jan 2018"~1)
trd$quarter<-case_when(BULAN=="Jan"~1)
trd$quarter<-case_when(trd$BULAN=="Jan"~1)
trd
trd$quarter<-case_when(trd$BULAN=="Jan"|"Feb"|"Mar"~1)
trd$quarter<-case_when(trd$BULAN=="Jan"|BULAN=="Feb"|BULAN=="Mar"~1)
trd$quarter<-trd|>case_when(BULAN=="Jan"|BULAN=="Feb"|BULAN=="Mar"~1)
trd$quarter<-trd |>
case_when(BULAN=="Jan"|BULAN=="Feb"|BULAN=="Mar"~1)
trd$quarter<-case_when(trd$BULAN=="Jan"|trd$BULAN=="Feb"|trd$BULAN=="Mar"~1)
trd
trd$quarter<-case_when(trd$BULAN=="Jan"|trd$BULAN=="Feb"|trd$BULAN=="Mar"~1)
trd$quarter<-case_when(trd$BULAN=="Apr"|trd$BULAN=="May"|trd$BULAN=="Jun"~2)
trd$quarter<-case_when(trd$BULAN=="Jul"|trd$BULAN=="Aug"|trd$BULAN=="Sep"~3)
trd$quarter<-case_when(trd$BULAN=="Oct"|trd$BULAN=="Nov"|trd$BULAN=="Dec"~4)
trd$dates<-as.yearmon(paste(trd$Tahun, " ", trd$mo), "%Y %m")
trd$date<-as.yearqtr(paste(trd$Tahun, " ", trd$mo), "%Y %m")
trd
trd$quarter<-case_when(trd$BULAN=="Jan"|trd$BULAN=="Feb"|trd$BULAN=="Mar"~1)
trd
trd$quarter<-case_when(trd$BULAN=="Jan"|trd$BULAN=="Feb"|trd$BULAN=="Mar"~1)
trd$quarter<-case_when(trd$BULAN=="Apr"|trd$BULAN=="May"|trd$BULAN=="Jun"~2)
trd$quarter<-case_when(trd$BULAN=="Jul"|trd$BULAN=="Aug"|trd$BULAN=="Sep"~3)
trd$quarter<-case_when(trd$BULAN=="Oct"|trd$BULAN=="Nov"|trd$BULAN=="Dec"~4)
trd
trd$quarter<-case_when(trd$BULAN=="Jan"|trd$BULAN=="Feb"|trd$BULAN=="Mar"~1)
trd
trd$quarter<-case_when(trd$BULAN=="Apr"|trd$BULAN=="May"|trd$BULAN=="Jun"~2)
trd
trd$quarter<-case_when(trd$BULAN=="Jan"|trd$BULAN=="Feb"|trd$BULAN=="Mar"~1,
trd$BULAN=="Apr"|trd$BULAN=="May"|trd$BULAN=="Jun"~2,
trd$BULAN=="Jul"|trd$BULAN=="Aug"|trd$BULAN=="Sep"~3,
trd$BULAN=="Oct"|trd$BULAN=="Nov"|trd$BULAN=="Dec"~4)
trd
trd$date<-as.yearqtr(paste(trd$Tahun, " ", trd$quarter), "%Y %m")
trd
trd$date<-as.yearqtr(paste(trd$Tahun, " ", trd$quarter), "%Y %q")
trd
trd |>
group_by(date,`JENIS HT`) |>
summarise(weq=sum(`CUKAI (RP T)`))
trd2<-trd |>
group_by(date,`JENIS HT`) |>
summarise(weq=sum(`CUKAI (RP T)`))
trd2
prices<-read_excel("excise/trad_prices.xlsx")
prices
prices$date<-as.yearqtr(paste(prices$tahun, " ", trd$quarter), "%Y %q")
prices
prices$date<-as.yearqtr(paste(prices$tahun, " ", prices$quarter), "%Y %q")
prices
left_join(trd2,prices)
rd<-read_excel("excise/cukai_use2.xlsx")
trd$mo<-"mo"
trd<-trd |> mutate(mo=case_when(BULAN=="Jan"~"01",
BULAN=="Feb"~"02",
BULAN=="Mar"~"03",
BULAN=="Apr"~"04",
BULAN=="May"~"05",
BULAN=="Jun"~"06",
BULAN=="JUL"~"07",
BULAN=="Aug"~"08",
BULAN=="Sep"~"09",
BULAN=="Oct"~"10",
BULAN=="Nov"~"11",
BULAN=="Dec"~"12"))
trd$dates<-as.yearmon(paste(trd$Tahun, " ", trd$mo), "%Y %m")
trd$quarter<-case_when(trd$BULAN=="Jan"|trd$BULAN=="Feb"|trd$BULAN=="Mar"~1,
trd$BULAN=="Apr"|trd$BULAN=="May"|trd$BULAN=="Jun"~2,
trd$BULAN=="Jul"|trd$BULAN=="Aug"|trd$BULAN=="Sep"~3,
trd$BULAN=="Oct"|trd$BULAN=="Nov"|trd$BULAN=="Dec"~4)
trd$date<-as.yearqtr(paste(trd$Tahun, " ", trd$quarter), "%Y %q")
trd2<-trd |>
group_by(date,`JENIS HT`) |>
summarise(weq=sum(`CUKAI (RP T)`))
trd2
trd<-read_excel("excise/cukai_use2.xlsx")
trd
trd<-read_excel("excise/cukai_use2.xlsx")
library(tidyverse)
library(readxl)
library(writexl)
## CREATING NEW QUARTERLY DATA
trd<-read_excel("excise/cukai_use2.xlsx")
trd
trd$mo<-"mo"
trd<-trd |> mutate(mo=case_when(BULAN=="Jan"~"01",
BULAN=="Feb"~"02",
BULAN=="Mar"~"03",
BULAN=="Apr"~"04",
BULAN=="May"~"05",
BULAN=="Jun"~"06",
BULAN=="JUL"~"07",
BULAN=="Aug"~"08",
BULAN=="Sep"~"09",
BULAN=="Oct"~"10",
BULAN=="Nov"~"11",
BULAN=="Dec"~"12"))
trd$dates<-as.yearmon(paste(trd$Tahun, " ", trd$mo), "%Y %m")
trd
library(tidyverse)
library(readxl)
library(writexl)
library(zoo)
## CREATING NEW QUARTERLY DATA
trd<-read_excel("excise/cukai_use2.xlsx")
trd$mo<-"mo"
trd<-trd |> mutate(mo=case_when(BULAN=="Jan"~"01",
BULAN=="Feb"~"02",
BULAN=="Mar"~"03",
BULAN=="Apr"~"04",
BULAN=="May"~"05",
BULAN=="Jun"~"06",
BULAN=="JUL"~"07",
BULAN=="Aug"~"08",
BULAN=="Sep"~"09",
BULAN=="Oct"~"10",
BULAN=="Nov"~"11",
BULAN=="Dec"~"12"))
trd$dates<-as.yearmon(paste(trd$Tahun, " ", trd$mo), "%Y %m")
trd$quarter<-case_when(trd$BULAN=="Jan"|trd$BULAN=="Feb"|trd$BULAN=="Mar"~1,
trd$BULAN=="Apr"|trd$BULAN=="May"|trd$BULAN=="Jun"~2,
trd$BULAN=="Jul"|trd$BULAN=="Aug"|trd$BULAN=="Sep"~3,
trd$BULAN=="Oct"|trd$BULAN=="Nov"|trd$BULAN=="Dec"~4)
trd$date<-as.yearqtr(paste(trd$Tahun, " ", trd$quarter), "%Y %q")
trd2<-trd |>
group_by(date,`JENIS HT`) |>
summarise(weq=sum(`CUKAI (RP T)`))
trd
trd2<-trd |>
group_by(date,kind) |>
summarise(RT=sum(RT)) |>
summarise(QM=sum(QM))
trd
trd2<-trd |>
group_by(date,kind) |>
summarise(RT=sum(RT),QM=sum(QM))
trd2
prices<-read_excel("excise/trad_prices.xlsx")
prices$date<-as.yearqtr(paste(prices$tahun, " ", prices$quarter), "%Y %q")
left_join(trd2,prices,by(date,kind))
left_join(trd2,prices,by=c(date,kind))
prices<-read_excel("excise/trad_prices.xlsx")
prices$date<-as.yearqtr(paste(prices$tahun, " ", prices$quarter), "%Y %q")
left_join(trd2,prices,by=c(date,kind))
trd2
prices
left_join(trd2,prices,by=date))
left_join(trd2,prices,by=date)
left_join(trd2,prices)
left_join(trd2,prices,by=join_by(date,kind))
trd3<-left_join(trd2,prices,by=join_by(date,kind))
trd3 |>
ggplot(aes(x=date,y=QM,color=kind,linetype=kind,shape=kind))+geom_line(linewidth=1.1)+
geom_point(size=1.1)
View(trd2)
View(trd)
trd3$CR<-trd3$RT/trd$QM
trd3$CR<-trd3$RT/trd3$QM
trd3
trd3$CB<-trd3$RT/trd3$QM*1000
trd
trd3
trd3 |> write_xlsx("final_data.xlsx")
trd3$CB<-trd3$RT/trd3$QM*1000
trd3$CR<-trd3$CB/trd3$htp*1000
trd3
trd3$CR<-trd3$CB/trd3$htp
trd3
trd3 |>
ggplot(aes(x=date,y=QM,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Quantity (billion batang)")
trd3 |>
ggplot(aes(x=date,y=htp,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Prices (IDR/batang)")
trd3 |>
ggplot(aes(x=date,y=RT,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Revenue (Trillion IDR)")
trd3 |>
ggplot(aes(x=date,y=CR,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="advalorem equivalent (%)")
a<-trd3 |>
ggplot(aes(x=date,y=QM,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Quantity (billion batang)")
b<-trd3 |>
ggplot(aes(x=date,y=htp,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Prices (IDR/batang)")
c<-trd3 |>
ggplot(aes(x=date,y=RT,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Revenue (Trillion IDR)")
d<-trd3 |>
ggplot(aes(x=date,y=CR,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="advalorem equivalent (%)")
a+b+c+d
a
library(patchwork)
a+b+c+d
wrap_plots(a+b+c+d)
## Plots
a<-trd3 |>
ggplot(aes(x=date,y=QM,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Quantity (billion batang)")+theme(legend.position = "none")
b<-trd3 |>
ggplot(aes(x=date,y=htp,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Prices (IDR/batang)")+theme(legend.position = "none")
c<-trd3 |>
ggplot(aes(x=date,y=RT,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Revenue (Trillion IDR)")+theme(legend.position = "none")
d<-trd3 |>
ggplot(aes(x=date,y=CR,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="advalorem equivalent (%)")
wrap_plots(a+b+c+d)
a<-trd3 |>
ggplot(aes(x=date,y=QM,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Quantity (billion batang)")+theme(legend.position = "none")
b<-trd3 |>
ggplot(aes(x=date,y=htp,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Prices (IDR/batang)")+theme(legend.position = "none")
c<-trd3 |>
ggplot(aes(x=date,y=RT,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Revenue (Trillion IDR)")+theme(legend.position = "none")
d<-trd3 |>
ggplot(aes(x=date,y=CR,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="advalorem equivalent (%)")++theme(legend.position = "bottom")
a<-trd3 |>
ggplot(aes(x=date,y=QM,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Quantity (billion batang)")+theme(legend.position = "none")
b<-trd3 |>
ggplot(aes(x=date,y=htp,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Prices (IDR/batang)")+theme(legend.position = "none")
c<-trd3 |>
ggplot(aes(x=date,y=RT,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Revenue (Trillion IDR)")+theme(legend.position = "none")
d<-trd3 |>
ggplot(aes(x=date,y=CR,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="advalorem equivalent (%)")+theme(legend.position = "bottom")
wrap_plots(a+b+c+d)
a<-trd3 |>
ggplot(aes(x=date,y=QM,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Quantity (billion batang)")+theme(legend.position = "none")
b<-trd3 |>
ggplot(aes(x=date,y=htp,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Prices (IDR/batang)")+theme(legend.position = "none")
c<-trd3 |>
ggplot(aes(x=date,y=RT,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="Revenue (Trillion IDR)")+theme(legend.position = "none")
d<-trd3 |>
ggplot(aes(x=date,y=CR,color=kind,linetype=kind))+geom_line(linewidth=1.1)+
labs(y="advalorem equivalent (%)")+theme(legend.position = "bottom left")
wrap_plots(a+b+c+d)
getwd()
