---
title: "excise report"
author: "Krisna Gupta"
institute: "Prospera"
date: last-modified
date-format: long
bibliography: ref.bib
format:
  html:
    code-fold: true
  pdf:
    documentclass: scrreprt
    papersize: a4
  docx:
    toc: false
---

## Data

aowkaowkaowk

```{r}
#| echo: false
#| warning: false
#| message: false
#| error: false
library(tidyverse)
library(readxl)
library(modelsummary)
library(kableExtra)
library(gt)
theme_set(theme_classic())

dat<-read_excel("cukai_use.xlsx",sheet="gab")
dat2<-read_excel("cukai_use.xlsx",sheet="gabb")
trad<-read_excel("cukai_use.xlsx",sheet="trad")
trad2<-read_excel("cukai_use.xlsx",sheet="trad2")

plot(dat$qtrad,dat$ptrad,xlab="log quantity",ylab="log price")
plot(dat$revtrad,dat$ttrad,xlab="log revenue",ylab="tariff rate")

```

## Method

Let a standard elasticity parameters

$$
Q_i=AP_i^{-\varepsilon}
$$

which can be approximately log-linearized

$$
q_i=a-\varepsilon p_i
$$

where a lowercase is the log version of its uppercase counterparts. We can, thus, econometrically estimated the above equation with a regression. Additionally, we follow the theory in having an income elasticity with GDP per capita as a proxy. We then estimate:

$$
q_{it}=a-\varepsilon p_{it} + \gamma y_{it} + \epsilon_{it}
$$

We assume an iid $\epsilon_{it}$ for now and uses own-price elasticity since we lack information on the price of electric cigs. The parameter $\varepsilon$ is the own-price elasticity of demand, which we expect to be negative, while $\gamma$ is the income elasticity of demand which is assumed to be positive.

## Results

We use data that are made available by DGCE for us. Data contains production, revenue, base price (HJE) for tax purposes and retail price (HTE) for consumers for various types of traditional and electric cigarettes. Unfortunately, the availability of those data differs quite tremendously. Some are collected monthly, some others are quarterly and annually. Common denominator suggests us to conduct the analysis annually.

Since we lack degree of freedom amid lack of data, it does make sense to group kinds of cigarettes into two: traditional and electric. We aggregate variables using weighted average using production data of each kind of cigarettes as the weight.

### Elasticities: traditional cigarettes

```{r}
summary(lm(qtrad~ptrad+y+kind,data=trad2))
```

kwkwk

```{r}
#| label: tbl-1
#| tbl-cap: Demand elasticity estimation for three kinds of traditional cigarettes

## Regressions
reg1<-lm(qtrad~ptrad+y,data=dat)
reg1skm<-lm(qskm~pskm+y,data=trad)
reg1skt<-lm(qskt~pskt+y,data=trad)
reg1spm<-lm(qspm~pspm+y,data=trad)

## Tabling

ela<- list(
  "Traditional" = reg1,
  "SKM"  = reg1skm,
  "SKT"  = reg1skt,
  "SPM"  = reg1spm
)

modelsummary(ela,stars = TRUE,coef_rename=c("ptrad"="own-price",
                                            "pskm"="own-price",
                                            "pskt"="own-price",
                                            "pspm"="own-price"))
```

The elasticity of the traditional cigarettes is `r reg1[["coefficients"]][2]` which is the decrease in sales if prices go up by 1%. Meanwhile, `r reg1[["coefficients"]][3]`is the income-effect, that is, how much more sales go up if GDP per capita rises by 1%.

We can then propose an elasticity equation as such:

$$
Q_{trad}=\frac{Y^{0.52}}{P_{trad}^{0.48}}\cdot e^{25.75}
$$

This parameter is actually make sense. The inelasticity of cigarette demands is quite well-known.

We also examine if it matters by different kinds:





### Tax-price pass through

In the terms of excise, DGCE is interested in knowing how much their additional excise matters for the change in prices, which in turn matter in the change in quantities. We estimate how much prices changes when excise changes with the following specification:

$$
\ln P_t = \alpha+\beta \ln T_t + \varepsilon_{t}
$$

The result of that regression is as follows:

```{r}
#| label: tbl-2
#| tbl-cap: Tax-to-price pass through for three kinds of traditional cigarettes

## Regressions
reg2<-lm(ptrad~ctrad,data=dat)
reg2skm<-lm(pskm~cskm,data=trad)
reg2skt<-lm(pskt~cskt,data=trad)
reg2spm<-lm(pspm~cspm,data=trad)

## Tabling

tpp<- list(
  "Traditional" = reg2,
  "SKM"  = reg2skm,
  "SKT"  = reg2skt,
  "SPM"  = reg2spm
)

modelsummary(tpp,stars = TRUE,coef_rename=c("ptrad"="own-price",
                                            "pskm"="own-price",
                                            "pskt"="own-price",
                                            "pspm"="own-price",
                                            "ctrad"="own-excise",
                                            "cskm"="own-excise",
                                            "cskt"="own-excise",
                                            "cspm"="own-excise"))
```

This estimation result tells us a very strong impact of taxation on prices. That is, for each 1% increase in excise, it passes `r reg1[["coefficients"]][2]` % to the consumer via increased price. This estimation is arguable higher than @Prasetyo618 which conducted a firm-level estimation.

### Revenue from price and from tax rate

```{r}
#| label: tbl-3
#| tbl-cap: tax elasticity of revenue for three kinds of traditional cigarettes

## Regressions
reg3<-lm(revtrad~ctrad+y,data=dat)
reg3skm<-lm(rskm~cskm+y,data=trad)
reg3skt<-lm(rskt~cskt+y,data=trad)
reg3spm<-lm(rspm~cspm+y,data=trad)

## Tabling

rev<- list(
  "Traditional" = reg3,
  "SKM"  = reg3skm,
  "SKT"  = reg3skt,
  "SPM"  = reg3spm
)

modelsummary(tpp,stars = TRUE,coef_rename=c("revtrad"="own-revenue",
                                            "rskm"="own-revenue",
                                            "rskt"="own-revenue",
                                            "rspm"="own-revenue",
                                            "ctrad"="own-excise",
                                            "cskm"="own-excise",
                                            "cskt"="own-excise",
                                            "cspm"="own-excise"))
```

## Electric

Unfortunately, analyzing electric cigarettes is heavily constrained by the data. Since 2022 is the only year with a complete observation of production, revenue and prices, we cannot use econometric methods. We can, however, construct a direct derivation of elasticity from a simple algebra.

Assume a demand function as follows:

$$
Q_{el}=AP_{el}^{\nu}
$$

We can derive the elasticity $\nu$ by first doing a log-lineraization

$$
\ln Q_{el} = \nu \ln P_{el}+\ln A
$$

While this structure allows for an estimation of $\nu$ and $A$ as the intercept, parameterizing both are impossible unless we have more than 1 data point at the very least[^1]. 

[^1]: Obviously the more data point the better. While 2 data points are enough for parameterisation, it is not ideal.

One of a way to estimate $\nu$ is to use $A$ from the traditional cigarettes estimation. 

which gives us:

$$
\nu= -\frac{\ln Q_{el}}{\ln P_{el}+\ln A}
$$




## Limitation & Suggestions

The main limitation is data. With the lack of annual data, we are limited to how much degree of freedom we can utilise. That is, we are limited to how much variable we can use in a single regression. Among the limitations are:

- traditional cigarettes:

    - quarterly HTP:HJE data is useful.
    
    - production and revenue data is annual. Common denominator principle suggests we can only use annual data.
    
    - Data is limited to 2018-2022 for a full year of observation.

- electronic cigarettes:

    - excellent monthly production and revenue data. However, monthly data often prone to seasonality and cyclicality.
    
    - HJE and HTP are only available for June 2022 and June 2023.
    
    - Names of cigs are different between different years.
    
    - consequence is more severe: only 2022 observation can be used.
    
Going forward, here are our recomendations regarding data for the DGCE:

- have a robust datasets which can easily be extracted into familiar form.
    
- Keep collecting monthly data even though some HTP and HJE (or other regulations) do not change.
    
- We propose a structure which can be extremely useful for future usage.
    
For further analysis, we can recommend the use of other datasets, such as Susenas or other household surveys. Unfortunately, there is no going around the lack of data. Even if we can utilise other data, we will still need HTP:HJE and annual revenue from the DGCE.